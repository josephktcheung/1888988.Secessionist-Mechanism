# 错误报告：归并国机制

## 元数据

**标题：** 归并国机制 - 强制参与、忽略原始所有者、世界大战升级和利用

**问题类型：** 游戏玩法

**错误类型：** AI（非玩家角色）、其他

**游戏版本：** 1.0.10

---

## 摘要

归并国机制存在严重的设计缺陷，导致游戏破坏性利用。同文化国家在玩家无法控制的情况下被强制召唤参战，**完全忽略原始所有权**，优先考虑文化主导地位。该机制破坏联合统治，造成不一致的战争领导逻辑（附庸领导归并国内战，而正常战争宣战中宗主国领导），当附庸领导战争时阻止玩家控制，错误地应用停战协议惩罚，并允许吞并叛军按钮吞并整个参战国（例如，法兰西）而不产生敌意。不对称的同盟召唤机制造成危险的世界战争升级，防御方可以协调，而被迫召唤的进攻方无法协调。无地归并国叛乱（群众集会）产生不一致的结果，文化主导国家战斗后一无所获，而有地叛乱则成为附庸。这些缺陷使系统性利用成为可能：（1）附庸玩家可以使用宗主国作为武器攻击同文化国家（已验证）；（2）玩家可以通过触发归并国叛乱在停战协议期间攻击对手，迫使受害者加入并受到 -50 稳定度惩罚。

---

## 描述

归并国机制存在十二个严重问题：

### 问题 1：同文化国家被迫加入（最严重）

当归并国叛军时，系统自动搜索附近同文化国家，并强制召唤它们加入叛军一方参战。被召唤的国家无法拒绝。如果它们与敌人有停战协议，会被错误地判定为主动破坏停战协议，触发严重惩罚（-50 稳定度，+1 厌战度，+25 敌意）。选择机制在引擎中硬编码，无法在游戏文件中找到，使玩家无法预测哪个国家会被召唤。

**严重缺陷：完全忽略原始所有权**

系统在选择要召唤的同文化国家时**完全忽略原始所有权**，优先考虑文化主导地位而非历史主张。

*来自拜占庭存档的示例：* 土耳其归并国叛乱发生在原本由奥斯曼拥有的领土上。奥斯曼仍然存在，是原始所有者。然而，系统选择埃雷特纳（文化主导的土耳其国家），完全忽略奥斯曼。奥斯曼没有机会收回其前领土，尽管它们拥有最强的历史主张。

### 问题 2：联合统治破裂（严重 - 已验证）

当联合统治邦联从属国是归并国叛乱的文化主导国家时，它被强制召唤支持叛乱对抗其邦联主导国。这立即破坏联合统治，因为 `union_of_crowns_pact` 具有 `break_on_war = yes`。

**验证状态：**
- 联合统治：**已验证受影响**（使用法兰西-西西里测试）
- 附庸：**已验证被排除**（使用法兰西-西西里测试）
- 采邑：**已验证被排除**（使用法兰西-西西里测试）
- 其他属国类型（朝贡国、自治领、卫戍国、封邑、三曼多、土司、乌奇贝伊等）：未测试

这造成不一致性，联合统治容易受到影响，而其他一些属国类型受到保护。

**验证：** 使用法兰西（邦联主导国）和西西里（邦联从属国）进行测试。当西西里归并国叛军在法兰西控制的领土上时，西西里被强制召唤，立即破坏联合统治。当西西里是附庸或采邑时，它被正确排除。

### 问题 3：附庸战争领导问题（严重）

如果玩家创建的附庸在内战中成为防御方，玩家会被强制拖入战争，但不会成为战争领袖。AI 附庸控制所有和平谈判。玩家无法召唤同盟，无法获得军事通行权，必须在没有控制的情况下承担所有战争成本。

**严重不一致：正常战争宣战 vs. 归并国内战**

在正常战争宣战和归并国内战之间，关于附庸战争领导的游戏逻辑存在根本性不一致：

**正常战争宣战（使用宣战理由和外交官）：**
- 当国家向附庸宣战时（例如，拜占庭向阿尔巴尼亚宣战，其中阿尔巴尼亚是那不勒斯的附庸），宗主国（那不勒斯）成为战争领袖，而非附庸（阿尔巴尼亚）
- 宗主国控制所有和平谈判和战争决策
- 这是正常战争宣战的预期行为

**归并国内战（问题 3）：**
- 当附庸在归并国内战中成为防御方时，附庸成为战争领袖，而非宗主国
- 宗主国被强制拖入战争，但不控制和平谈判
- AI 附庸控制所有和平谈判，而宗主国没有控制权

**不一致性：**
- **正常战争宣战：** 当附庸被攻击时，宗主国是战争领袖
- **归并国内战：** 当附庸是防御方时，附庸是战争领袖
- 这造成不一致的游戏逻辑，相同的关系（宗主国-附庸）根据战争开始方式产生不同的战争领导结果
- 玩家无法仅根据关系结构预测或理解哪一方将控制战争

**影响：**
- 对期望一致行为的玩家造成困惑
- 使基于属国关系预测战争领导变得不可能
- 破坏不同战争类型之间的游戏逻辑一致性
- 在归并国内战中，宗主国失去在常规战争中通常拥有的控制权

### 问题 4：同盟自动召唤的不一致性

当玩家是防御性战争领袖时，可以请求同盟加入。但当附庸是防御性战争领袖时，玩家无法召唤同盟加入。

**严重限制：被强制召唤的文化主导国家（进攻方）无法使用人情召唤同盟**

当同文化国家被强制召唤支持归并国叛乱作为进攻方时，它**无法使用人情召唤其同盟**，因为它不是战争领袖（叛乱国家是战争领袖）。

**已验证：无法在战争期间整合归并国附庸**

在归并国附庸是战争领袖的持续战争中，**不可能**整合/吞并归并国附庸。游戏阻止吞并处于内战中的国家（参见 `ANNEX_TARGET_CIVIL_WAR_PENALTY` 本地化："目前正在经历内战，在恢复和平之前无法被吞并"）。

**文化主导国家可以召唤同盟的唯一场景：**

**当无地归并国叛军被防御方消灭时**：如果归并国叛乱作为群众集会（无地且无领土）生成，其部队被防御方消灭，叛乱从战争中移除。参战的文化主导国家随后自动成为战争领袖，可以使用人情召唤同盟（成本：每个同盟 10 人情）。

**技术验证：**
- 归并国附庸在它们是战争领袖的持续战争中无法被整合/吞并（被内战限制阻止）
- `ask_join_war_for_favors` 交互要求召唤者是战争领袖（`attacker_leader = scope:actor` 或 `defender_leader = scope:actor`）
- 成本：每个同盟 10 人情（来自 `ask_join_war_for_favors_cost`）
- 战争领导转移：当无地叛军（战争领袖）被消灭时，剩余的参战国自动成为新的战争领袖

**影响：**
- 被强制召唤的文化主导国家在整个战争中处于严重劣势，除非无地叛军被防御方消灭，否则无法召唤同盟
- 这造成不对称情况，防御方从第一天起就可以与同盟协调，而文化主导的进攻方无法协调（参见问题 9）
- 文化主导进攻方获得召唤同盟能力的唯一方式取决于防御方的行动（消灭无地叛军），使防御方控制攻击者何时可以召唤同盟

### 问题 5：包围网绕过机制（严重利用）

当被强制召唤的国家处于包围网中时，它无法召唤包围网成员加入战争，因为它是进攻方。这允许防御方绕过包围网限制，单独攻击包围网成员。

### 问题 6：AI 附庸次优和平决策

AI 附庸可能选择无条件和平，而不是吞并叛乱者，即使吞并成本很低，导致玩家失去本应获得的领土。

### 问题 7：宗主国被迫加入

归并国通过 `secessionists.txt` 中的 `join_offensive_wars_always` 和 `join_defensive_wars_always` 自动强制召唤宗主国参战。

### 问题 8：停战协议破坏惩罚

有停战协议的被强制召唤国家被错误地判定为主动破坏停战协议，触发严重惩罚，尽管它们没有选择。

### 问题 9：世界大战升级 - 不对称同盟召唤（严重）

由于不对称的同盟召唤机制，单个地方归并国叛乱可能升级为世界大战。这**比历史世界大战**（第一次世界大战/第二次世界大战）更糟糕，在历史世界大战中双方都可以与同盟协调。

**当前 EU5 系统 - 比历史世界大战更糟糕：**

当归并国叛乱爆发时：
- 防御方可以从第一天起召唤所有同盟加入防御性战争
- 被强制召唤的同文化国家（进攻方）无法使用人情召唤自己的同盟，因为它不是战争领袖（叛乱国家是战争领袖）
- **文化主导进攻方可以召唤同盟的唯一例外场景**（详见问题 4）：
  - 无地归并国叛军被防御方消灭后（自动成为战争领袖）
- **已验证：无法在战争期间整合归并国附庸** - 处于内战中的国家在恢复和平之前被阻止吞并
- 结果：地方叛乱升级为重大战争，一个同盟集团在整个战争中独自对抗另一个集团的协调响应（除非防御方消灭无地叛军，这很罕见，并使防御方控制攻击者何时可以召唤同盟）

*示例场景（18 世纪晚期 - 瓜分时代）：*
- 两个主要同盟集团：集团 A（俄罗斯、奥地利、普鲁士）vs 集团 B（法兰西、奥斯曼、瑞典、波兰）
- 波兰归并国叛乱在俄罗斯控制的领土上爆发
- 波兰（文化主导）被迫加入叛乱一方（进攻方）- 没有选择
- 俄罗斯（防御方）召唤奥地利和普鲁士 → 3 个主要国家 vs 波兰
- 波兰（进攻方）无法召唤法兰西、奥斯曼或瑞典（它在集团 B 中的同盟）→ 独自对抗 3 个主要国家

这造成危险的升级机制，防御方可以系统性地使用归并国叛乱不对称地攻击敌人的同盟集团。

### 问题 10：吞并叛军按钮误用于参战国（严重 - 游戏破坏性）

当归并国叛乱由于人口规模较小（省份的叛乱文化人口 <50%）而作为群众集会（无地且无领土的国家）生成时，叛军国家没有领土。当叛军国家的部队被消灭且叛乱被消除时，战争继续进行，参战国成为战争领袖。吞并叛军按钮设计用于吞并整个叛乱者国家，然后可以用于吞并整个参战国（例如，法兰西 - 游戏开始时第三大国家），且不产生敌意。

**利用流程（英格兰 vs 法兰西示例）：**

1. **英格兰生成一个成为群众集会的法国叛乱**（防御方 - 拥有法国文化的叛乱领土）
2. **法兰西被强制召唤**作为进攻方（法国文化的文化主导国家）
3. **战争结构：** 英格兰（防御方/战争领袖）vs 叛乱（进攻方/战争领袖）+ 法兰西（进攻方/参战国）
4. **英格兰消灭群众集会部队**（叛乱被消除）
5. **战争继续进行**，因为法兰西仍在战争中
6. **法兰西成为战争领袖**（唯一剩余的进攻方）
7. **英格兰获得战争分数**，通过累积战争分数（来自 `take_country_nationalist` 战争目标的每月 `ticking_war_score = 0.5`）以及通过赢得战斗、围攻敌人地点和建立封锁
8. **英格兰达到 10 战争分数** - 当英格兰达到至少 10 战争分数时，吞并叛军按钮被启用（来自游戏定义的 `MIN_WARSCORE_TO_DEMAND = 10`）
9. **吞并叛军按钮变为可用** - 一旦启用，此和平选项可以用于参战国（法兰西），而不是已消除的叛乱者
10. **英格兰使用吞并叛军按钮**吞并整个法兰西国家
11. **英格兰以有效 0 成本吞并整个法兰西**（来自 `take_country_nationalist` 战争目标的基础 25% 成本，但被 `PEACE_COST_MODIFIER_FOR_REVOLT_WAR` 修正值减少 -95%，使其有效成本为 0）。这仅用于吞并叛乱者，而非像法兰西这样的主要国家
12. **不产生敌意** - 吞并像法兰西这样的主要国家应该产生大量敌意，但和平选项不产生任何敌意

**技术细节：**
- 当叛乱省份的叛乱文化人口 <50% 时，叛乱作为 `country_type = pop`（群众集会 - 无地且无领土）生成
- 当 `country_type = pop` 部队被消灭时，叛乱从战争中移除
- 参战国自动成为战争领袖
- **错误：** `take_country_nationalist` 战争目标具有 `type = take_country`，允许通过吞并叛军按钮吞并整个国家
- **错误：** 战争分数成本有效为 0（来自 `take_country_nationalist` 中 `conquer_cost = 0.25` 的基础 25%，但被 `PEACE_COST_MODIFIER_FOR_REVOLT_WAR = -0.95` 修正值减少 -95%，使其有效成本为 0）
- **错误：** 吞并参战国时不产生敌意
- **注意：** 如果防御方是战争领袖，理论上可以以 25% 成本征服土地（来自 `take_country_nationalist` 战争目标），但当附庸在归并国叛乱中是战争领袖时，AI 附庸永远不会为其宗主国征服土地（参见问题 6）

**影响：**
- **游戏破坏性：** 像法兰西（游戏开始时第三大国家）这样的主要国家可以通过此利用被像英格兰这样较小的国家吞并
- **已验证示例 1：** 法兰西通过此机制被英格兰吞并 - 英格兰生成一个成为群众集会的叛乱，法兰西被强制召唤，英格兰消灭叛军，获得 10 战争分数（最低要求），然后使用吞并叛军按钮吞并整个法兰西，且未产生敌意
- **已验证示例 2：** 札剌亦儿通过此机制被奥斯曼吞并 - 奥斯曼在古穆沙内地点只有很少的伊拉克文化人口（只有 31 个伊拉克文化贵族叛乱，<50% 地点人口），生成一个只有 3 名士兵的群众集会叛乱，而不是使地点成为叛乱领土。因为这是伊拉克文化叛乱，札剌亦儿（伊拉克文化主导国家）被强制召唤。奥斯曼消灭了 3 名士兵（群众集会消失），札剌亦儿成为战争领袖，奥斯曼通过围攻几个要塞获得 10% 战争分数，然后使用吞并叛军按钮吞并整个札剌亦儿。被吞并的土地是未整合领土，需要手动核心化

### 问题 11：属国被迫支持遥远叛乱（严重）

任何恰好是叛乱文化文化主导的属国（例如，附庸、归并国属国或其他属国类型）都会被强制召唤支持同文化的遥远叛乱，即使它们距离数千公里且与叛乱没有逻辑联系。

**问题：**
- 当归并国叛乱爆发时，系统搜索文化主导国家进行召唤
- 系统不检查国家是否是属国、其大小或与叛乱的距离
- 任何与叛乱人口同文化的国家都可能被召唤，无论它是否是属国
- 结果：小属国（例如，附庸、归并国属国）被强制召唤支持数千公里外的叛乱

**已验证示例：**
- 玩家（元/明）在蒙古地区有一个小的蒙古文化属国（例如，附庸或归并国属国）
- 蒙古归并国叛乱在格鲁吉亚爆发（6000+ 公里外）
- 小属国被迫加入叛乱一方（进攻方）- 没有选择
- 玩家的属国被拖入遥远的战争，玩家无法控制
- 玩家必须搜索参战国以找出其属国为何参战
- 属国受到惩罚（停战协议破坏、厌战度、敌意），尽管它没有选择
- 宗主国（元）也被拖入战争（问题 7），加剧了问题

**为何这有问题：**
- **没有逻辑联系：** 蒙古的小属国没有理由支持格鲁吉亚的叛乱
- **没有玩家控制：** 玩家无法阻止其属国被召唤
- **隐藏原因：** 玩家必须调查以找出其属国为何参战
- **无选择的惩罚：** 属国因未选择的行为受到严重惩罚
- **宗主国被拖入：** 宗主国也被迫加入（问题 7），造成强制参与的连锁反应
- **可被利用：** 防御方可以使用此机制强制小属国及其宗主国参战

**技术细节：**
- `on_civil_war_start` 中的硬编码机制不检查 `is_subject = yes` 或属国类型
- 系统只检查文化主导地位，忽略属国状态、距离和大小
- 属国在召唤目的上与独立国家同等对待

**影响：**
- 小属国被拖入它们不感兴趣的遥远战争
- 玩家失去对其属国外交政策的控制
- 造成困惑和挫败感（玩家必须调查属国为何参战）
- 使防御方能够利用此机制强制小属国和宗主国参战

### 问题 12：有地与无地归并国叛乱的不一致行为（严重）

当归并国叛乱生成时，其行为根据它是有地（拥有领土）还是无地（群众集会，无领土）而有显著不同。这造成不一致的结果，破坏预期的归并国机制。

**问题：**

**有地归并国叛乱（>50% 文化人口）：**
- 当叛乱爆发时，它控制领土
- 当叛乱赢得独立时，它成为文化主导国家的归并国附庸
- 文化主导国家获得新的附庸作为支持叛乱的奖励

**无地归并国叛乱（<50% 文化人口 - 群众集会）：**
- 当叛乱爆发时，它没有领土（只有人口）
- 当叛乱赢得独立时，它有两种不一致的结果：
  1. **成为独立国家**，而非文化主导国家的附庸
  2. **成为无地归并国附庸**，没有领土（只有 1 个单位骑兵，5 人）- 实际上无用
- 文化主导国家战斗后几乎一无所获 - 即使在 100% 战争分数时也只有最少的战争赔款（314.82 到 350.72 杜卡特）
- AI 文化主导国家即使在 100% 战争分数时也可能不占领任何土地，只接受战争赔款
- **严重：** 整个分离主义概念对无地叛军完全失效 - 文化主导国家在主要国家之间（例如，法兰西 vs 卡斯蒂利亚）进行重大战争，基本上一无所获

**已验证示例：**

**示例 1 - 无地叛军（英格兰 vs 法兰西）：**
- 英格兰生成一个成为群众集会的法国叛乱（<50% 法国文化人口）
- 法兰西（文化主导）被强制召唤支持叛乱
- 法兰西战斗并达到 100% 战争分数
- 无地叛乱成为**独立**国家（而非法兰西的附庸）
- 尽管战斗了整个战争，法兰西只收到一部分战争赔款（例如，238.09 杜卡特）
- 尽管以 100% 战争分数赢得战争，法兰西获得**无领土**和**无附庸**

**示例 2 - AI 不占领土地：**
- 在某些情况下，AI 文化主导国家即使在 100% 战争分数时也不占领任何土地
- AI 可能只接受战争赔款或无条件和约，使防御方保留所有领土完整
- 这与有地叛乱不一致，在有地叛乱中文化主导国家获得附庸

**示例 3 - 无地叛军行为（法兰西 vs 卡斯蒂利亚 - 已验证）：**
- 卡斯蒂利亚征服 Loudun（法国文化领土）
- 法国归并国叛乱作为群众集会生成（<50% 法国文化人口）
- 法兰西（文化主导）被强制召唤支持叛乱
- 法兰西与卡斯蒂利亚战斗（欧洲两个主要国家）并达到 100% 战争分数
- **结果 1：** 无地叛军（AAA00）成为法兰西的**无地归并国附庸**，没有领土，只有 1 个单位骑兵（5 人）- 实际上无用
- **结果 2：** 无地叛军成为**定居国家**，但**不是**法兰西的归并国附庸 - 完全独立
- 尽管以 100% 战争分数战斗了整个重大战争，法兰西只获得**314.82 到 350.72 杜卡特**（战争赔款）
- 法兰西获得**无领土**，要么**无有用附庸**（5 人的无地附庸），要么**完全无附庸**（独立国家）
- **总结：** 两个主要国家（法兰西和卡斯蒂利亚）为以下之一而战斗：（1）1 个单位骑兵（5 人）的无地归并国附庸，（2）独立定居国家，或（3）314.82 到 350.72 杜卡特。这证明分离主义概念对无地叛军完全失效 - 对于无地分离主义者来说，在分离主义战争中战斗几乎没有好处，因为所谓的宗主国法兰西几乎一无所获，如果无地叛军成为定居国家，它不会成为法兰西的有用附庸

**为何这有问题：**
- **不一致的结果：** 相同机制根据人口规模产生不同结果
- **对文化主导国家没有有意义的奖励：** 无地叛乱对被迫战斗的文化主导国家几乎没有好处 - 即使在 100% 战争分数时也只有最少的战争赔款（314-350 杜卡特）
- **两个有问题结果：** 无地叛军要么成为独立国家（无附庸奖励），要么成为无用的无地附庸，没有领土（只有 1 个单位 5 人）
- **重大战争一无所获：** 两个主要国家为基本上一无所获而战斗 - 文化主导国家尽管以 100% 战争分数获胜，但几乎没有任何好处
- **AI 次优行为：** AI 即使在应该占领土地时也可能不占领，浪费战争分数
- **破坏预期设计：** 归并国机制应该用有用的附庸奖励文化主导国家，但无地叛乱完全破坏此设计
- **对玩家不公平：** 被强制召唤进入无地叛乱战争的玩家几乎一无所获
- **分离主义概念失效：** 整个分离主义概念对无地叛军变得毫无意义，因为它们可以独立或成为无用的无地附庸

**技术细节：**
- 当省份的叛乱文化人口 <50% 时，叛乱作为 `country_type = pop`（群众集会 - 无地且无领土）生成
- 当 `country_type = pop` 赢得独立时，它有不一致的结果：
  1. 成为独立国家（而非附庸）
  2. 成为无地归并国附庸，没有领土（只有人口/单位，实际上无用）
- `secessionists.txt` 属国类型定义没有 `ai_wants_to_be_overlord`，这可能解释为什么 AI 不尝试将无地叛军变成有用的附庸
- `00_defines.txt` 中的 `PEACE_MAKE_SUBJECT_REVOLT_WAR = 0` 定义表明 AI 对在叛乱战争中制造属国没有兴趣，这解释了次优和平决策
- 即使无地叛军成为附庸，它们也没有领土和最小军事力量（例如，1 个单位骑兵，5 人），使它们实际上无用

**影响：**
- 文化主导国家从支持无地叛乱中几乎一无所获 - 即使在 100% 战争分数时也只有最少的战争赔款（314-350 杜卡特）
- 主要国家为基本上一无所获而进行重大战争（例如，法兰西 vs 卡斯蒂利亚，为了 5 人的无地附庸或独立国家）
- 玩家被迫战斗，几乎没有奖励
- AI 做出次优和平决策，即使在 100% 战争分数时也不占领土地
- 破坏归并国机制的预期设计，文化主导国家应该获得有用的附庸
- 整个分离主义概念对无地叛军变得毫无意义，因为它们要么成为独立国家，要么成为无用的无地附庸

---

## 利用场景

### 利用 1：附庸玩家使用宗主国作为武器（已验证）

选择作为附庸游戏的玩家可以系统性地使用其宗主国作为武器攻击和征服同文化国家的领土，然后最终宣布独立。

**利用策略**（已验证 - 拜占庭案例）：

1. 玩家选择作为附庸游戏（例如，拜占庭附庸 Hudavendigar）
2. 玩家通过各种方式故意增加归并国叛军每月进度（不核心化领土、低稳定度、低合法性、最大化税收、减少控制等）
3. 当归并国叛乱爆发时：
   - 宗主国（例如，拜占庭）自动被拖入防御方战争（问题 7）
   - 文化主导国家（例如，土耳其文化的埃雷特纳）被迫加入叛乱一方（进攻方）（问题 1）
   - 玩家的附庸成为防御性战争领袖，给玩家完全控制和平谈判
4. 玩家作为附庸战争领袖的优势：
   - 可以在第一天对叛军做出反应，立即派遣正规军占领叛军省份
   - 宗主国自动派遣部队帮助
   - 吞并叛军的战争分数很低（例如，2 分），容易实现
   - 任何额外的战争分数可用于向被强制召唤的参战国要求领土/金钱
5. 玩家根据军事情况控制战争持续时间
6. 玩家从战争中获得所有好处：来自被强制召唤参战国的领土和杜卡特，使用宗主国的军事力量而无需成本，为最终独立建立力量
7. 一旦足够强大，玩家宣布独立并击败削弱的宗主国

**验证：** 在拜占庭游戏中测试。玩家作为拜占庭附庸 Hudavendigar 游戏。土耳其归并国叛乱爆发，埃雷特纳（文化主导的土耳其国家）被强制召唤。拜占庭（宗主国）自动被拖入战争。玩家（作为附庸战争领袖）能够求和并征服埃雷特纳的领土。

**影响：**
- 附庸玩家可以系统性地利用其宗主国为他们战斗
- 无需制造宣称、创建宣战理由或管理停战协议计时器
- 可以使用宗主国的军事力量建立力量和资源
- 一旦足够强大，最终宣布独立
- 使附庸游戏玩法可被利用并破坏预期的游戏平衡
- 在多人游戏中，这允许附庸玩家系统性地削弱其宗主国玩家

### 利用 2：双重战争攻击

归并国机制造成严重利用，允许知识渊博的玩家在停战协议期间通过故意创建该停战协议期间，然后触发归并国叛乱，迫使受害者加入并受到毁灭性惩罚，从而攻击对手（AI 或人类玩家）。

**利用策略：**

1. 玩家 A（利用者）通过战争 1 或从游戏开始/先前征服中获得与玩家 B（受害者 - AI 或人类玩家）相同主要文化的领土
2. 玩家 A 故意允许或鼓励归并国叛乱发展（叛军进度接近 100%）
3. 玩家 A 在归并国叛乱即将爆发时（叛军进度接近 100%）向玩家 B 发动战争 2
4. 玩家 A 进行无条件和约或获得少量赎金，快速结束战争 2，创建新的停战协议期间
5. 玩家 A 在此新停战协议期间与其他国家/玩家形成同盟
6. 当归并国叛乱爆发时：
   - 玩家 B（文化主导）被迫加入叛乱一方（进攻方）
   - 玩家 B 因"破坏停战协议"受到 -50 稳定度惩罚（尽管是被迫的）
   - 玩家 B 无法召唤同盟或包围网成员，因为它是进攻方
   - 玩家 A（防御方）可以召唤所有同盟加入防御性战争
   - 结果：玩家 A 在停战协议期间攻击玩家 B，玩家 B 受到严重惩罚且无法有效防御

**影响：**
- 此利用完全破坏游戏平衡
- 知识渊博的玩家可以通过利用此机制系统性地摧毁对手（AI 或人类）
- 受害者国家没有反制手段 - 它们无法阻止归并国叛乱，无法拒绝召唤，无法召唤自己的同盟
- -50 稳定度惩罚可能导致国家崩溃，使受害者的游戏无法进行
- 这造成不公平优势，使游戏失去竞争力

**示例场景：**
- 玩家（法兰西）获得卡斯蒂利亚文化领土（如果需要，通过向卡斯蒂利亚的战争 1，或已经拥有它们）
- 玩家允许卡斯蒂利亚归并国叛乱发展（叛军进度接近 100%）
- 玩家在卡斯蒂利亚叛乱达到 95% 进度时向对手（卡斯蒂利亚 - AI 或人类玩家）宣战 2
- 玩家快速白和战争 2，创建新的停战协议期间
- 玩家在此新停战协议期间与阿拉贡和罗马形成同盟
- 卡斯蒂利亚归并国叛乱爆发
- 对手（卡斯蒂利亚）被迫加入叛乱一方，受到 -50 稳定度，无法召唤同盟
- 玩家召唤阿拉贡和罗马，以压倒性优势再次攻击对手
- 对手的国家因稳定度惩罚而崩溃，无法有效防御

### 利用 3：吞并叛军按钮 - 以 0 成本吞并主要国家（游戏破坏性 - 已验证）

吞并叛军按钮设计用于吞并归并国叛军，但可被误用于以有效 0 成本吞并整个主要参战国，且不产生敌意。

**利用策略**（已验证 - 英格兰 vs 法兰西 和 奥斯曼 vs 札剌亦儿）：

1. 玩家获得人口较少（<50% 地点人口）且与主要国家主要文化匹配的领土
2. 玩家故意允许或鼓励归并国叛乱在这些领土上发展
3. 当叛乱生成时，由于人口较少，它成为群众集会（无地且无领土）
4. 文化主导的主要国家（例如，法兰西代表法国文化，札剌亦儿代表伊拉克文化）被强制加入叛乱一方（进攻方）（问题 1）
5. 玩家（防御方）消灭群众集会部队，消除叛乱
6. 战争继续进行，因为主要国家仍在战争中
7. 主要国家成为战争领袖（唯一剩余的进攻方）
8. 玩家通过累积战争分数和军事行动获得战争分数
9. 玩家达到 10 战争分数（最低要求）- 吞并叛军按钮被启用
10. 玩家使用吞并叛军按钮以有效 0 成本吞并整个主要国家（基础 25% 成本被 `PEACE_COST_MODIFIER_FOR_REVOLT_WAR` 修正值减少 -95%）
11. 尽管吞并了主要国家，但不产生敌意

**验证：**
- **已验证示例 1：** 法兰西通过此机制被英格兰吞并 - 英格兰生成一个成为群众集会的叛乱，法兰西被强制召唤，英格兰消灭叛军，获得 10 战争分数（最低要求），然后使用吞并叛军按钮吞并整个法兰西，且未产生敌意
- **已验证示例 2：** 札剌亦儿通过此机制被奥斯曼吞并 - 奥斯曼在古穆沙内地点只有很少的伊拉克文化人口（只有 31 个伊拉克文化贵族叛乱，<50% 地点人口），生成一个只有 3 名士兵的群众集会叛乱。因为这是伊拉克文化叛乱，札剌亦儿（伊拉克文化主导国家）被强制召唤。奥斯曼消灭了 3 名士兵（群众集会消失），札剌亦儿成为战争领袖，奥斯曼通过围攻几个要塞获得 10% 战争分数，然后使用吞并叛军按钮吞并整个札剌亦儿。被吞并的土地是未整合领土，需要手动核心化

**影响：**
- **游戏破坏性：** 像法兰西（游戏开始时第三大国家）这样的主要国家可以通过此利用被像英格兰这样较小的国家吞并
- 吞并主要国家时不产生敌意，破坏游戏平衡
- 有效 0 成本吞并主要国家（仅适用于小叛军）
- 完全破坏预期的游戏平衡

---

## 严重性

这些问题很严重，因为：
- 玩家对被拖入战争完全没有控制权
- **完全忽略原始所有者** - 系统忽略原始所有权，只考虑文化主导地位（例如，在拜占庭案例中忽略奥斯曼而选择埃雷特纳）
- **不一致的战争领导逻辑** - 在正常战争宣战中，当附庸被攻击时宗主国成为战争领袖，但在归并国内战中，附庸反而成为战争领袖。这造成不可预测和不一致的游戏逻辑，破坏玩家期望
- 联合统治因强制参与而意外破裂
- 玩家因未选择的行为受到严重惩罚（-50 稳定度）
- **作为群众集会生成的叛乱导致战争分数成本应用于错误目标** - 当群众集会部队被消灭且叛乱被消除时，战争继续进行，参战国成为战争领袖。吞并叛军按钮（仅用于吞并叛军）然后可以用于以有效 0 成本吞并整个参战国（来自 `take_country_nationalist` 战争目标的基础 25% 成本，但被 `PEACE_COST_MODIFIER_FOR_REVOLT_WAR` 修正值减少 -95%，使其有效成本为 0）。这允许像法兰西（游戏开始时第三大国家）这样的主要国家被像英格兰这样较小的国家吞并。**注意：** 如果防御方是战争领袖，理论上可以以 25% 成本征服土地，但当附庸在归并国叛乱中是战争领袖时，AI 附庸永远不会为其宗主国征服土地（参见问题 6）
- 知识渊博的玩家可以通过多种方式系统性地利用此机制（参见利用场景部分）
- 此机制违反历史合理性
- 玩家因 AI 决策而失去领土和战略控制
- 不一致性：联合统治与其他属国类型区别对待（附庸、采邑受到保护，联合统治不受保护）
- **利用 1：** 附庸玩家可以使用其宗主国作为武器攻击同文化国家，并最终宣布独立，破坏预期的游戏平衡
- **利用 2：** 玩家可以通过战争 2 故意创建停战协议期间，然后触发归并国叛乱，迫使受害者加入并受到 -50 稳定度惩罚，阻止受害者召唤同盟，从而在停战协议期间攻击对手（AI 或人类）。这在单人和多人游戏环境中完全破坏游戏平衡
- **利用 3：** 玩家可以通过生成无地归并国叛乱（群众集会），消灭叛军，然后在参战主要国家而非已消灭的叛军上使用吞并叛军按钮，以有效 0 成本吞并主要国家（例如，法兰西、札剌亦儿）。尽管吞并了主要国家，但不产生敌意（游戏破坏性 - 已验证）
- **世界大战升级：** 由于不对称的同盟召唤，单个地方叛乱可能升级为世界大战。防御方可以召唤所有同盟，而被强制召唤的进攻方无法召唤自己的同盟，造成危险的升级机制
- **小属国被拖入遥远战争：** 任何恰好是文化主导的属国（例如，附庸、归并国属国）都会被强制召唤支持同文化的遥远叛乱，即使距离数千公里。玩家失去对其属国外交政策的控制，必须调查以找出其属国为何参战（已验证：元案例 - 蒙古地区的小蒙古属国被迫支持 6000+ 公里外的格鲁吉亚叛乱）
- **有地与无地归并国的不一致行为：** 有地归并国叛乱（>50% 文化人口）在获胜时成为文化主导国家的附庸，而无地归并国叛乱（<50% 文化人口 - 群众集会）有不一致的结果：要么成为独立国家，要么成为无用的无地附庸（例如，1 个单位骑兵，5 人）。这造成不一致的结果，文化主导国家从战斗无地叛乱战争中几乎一无所获（即使在 100% 战争分数时也只有 314-350 杜卡特），整个分离主义概念对无地叛军完全失效。主要国家为基本上一无所获而进行重大战争（已验证：法兰西 vs 卡斯蒂利亚案例 - 法兰西以 100% 战争分数战斗整个战争，只获得 314.82 到 350.72 杜卡特，无领土或有用附庸；无地叛军要么成为独立国家，要么成为 5 人的无用无地附庸）

---

## 推荐优先级

问题 1、2、5 和 10 应优先处理，因为它们对游戏体验影响最严重，且玩家完全无法控制。问题 2（联合统治破裂）尤其严重，因为它造成不一致性，一种属国类型（联合统治）容易受到影响，而其他一些（附庸、采邑）受到保护。问题 10（吞并叛军按钮误用）是游戏破坏性的，因为它允许以 0 成本吞并主要国家。利用场景（利用 1、利用 2 和利用 3）使这更加关键，因为它们完全破坏了单人和多人游戏中的游戏平衡，使游戏对受害者来说不公平且无法游玩。需要进一步测试以确定其他属国类型（朝贡国、自治领、卫戍国、封邑等）是否也受到影响。

---

## 重现步骤

已准备多个游戏存档以演示这些问题。为每组提供存档文件 ID。

### 案例 1：拜占庭存档（演示问题 1、3、4、6 和 7）

存档文件 ID：**#f40b1288**

加载拜占庭存档文件。存档设置如下：
- 拜占庭已征服大部分奥斯曼领土
- 拜占庭释放附庸 Hudavendigar 并将所有奥斯曼领土割让给它
- 拜占庭与特拉比松有同盟
- 土耳其归并国叛乱准备生成（或已生成）
- **关键：** 叛乱领土原本由奥斯曼拥有。奥斯曼仍然存在，是这些领土的**原始所有者**。
- 埃雷特纳是土耳其文化的文化主导国家（这就是为什么它被选中支持）

**观察问题 1 的步骤**（同文化国家被迫加入）：

1. 加载拜占庭存档 1337.7.2 - Byzantium HUD Revolt 100%
2. 使用控制台命令将 Hudavendigar 中的土耳其叛乱进度设置为 100%
3. 当归并国叛军并宣布内战时，观察埃雷特纳（土耳其文化的文化主导国家）自动被强制召唤加入叛军一方参战（存档：1337.8.1 - Byzantium HUD ERE War）
4. **关键观察：** 观察奥斯曼（叛乱领土的原始所有者）被系统**完全忽略**。奥斯曼未被选中，尽管它们对这些领土拥有最强的历史主张。
5. 观察埃雷特纳无法拒绝此召唤 - 它在第一天被迫参战
6. 如果埃雷特纳与拜占庭有停战协议，观察它因"破坏停战协议"受到 -50 稳定度惩罚，尽管它没有选择
7. **注意：** 埃雷特纳被选中是因为它是土耳其文化的文化主导国家，但玩家无法预测此选择，因为机制在引擎中硬编码。**系统完全忽略原始所有权** - 奥斯曼（原始所有者）未被选中，因为它们不是文化主导的土耳其国家。

**观察问题 3 的步骤**（附庸战争领导）：

1. 加载拜占庭存档 1337.8.1 - Byzantium HUD ERE War
2. 当内战开始时，观察拜占庭在第一天被强制拖入战争
3. 检查战争面板 - 观察附庸 Hudavendigar 是防御性战争领袖，而非拜占庭
4. 尝试召唤盟友特拉比松参战 - 观察这是不可能的，因为拜占庭不是战争领袖
5. 尝试从阿赫或詹达尔请求军事通行权 - 观察这是不可能的，因为低意见或 `block_when_at_war = yes`
6. 观察拜占庭无法控制和平谈判 - 只有 AI 附庸 Hudavendigar 可以议和
7. 观察拜占庭无法获得军事通行权以攻击埃雷特纳，造成僵局

**观察问题 4 的步骤**（同盟自动召唤的不一致性）：

1. 加载拜占庭存档 1337.8.1 - Byzantium HUD ERE War
2. 当内战开始时，观察特拉比松（拜占庭的盟友）不会自动加入战争
3. 尝试手动召唤特拉比松 - 观察这是不可能的，因为拜占庭不是战争领袖
4. 这证明不一致性：如果拜占庭是战争领袖，拜占庭可以请求特拉比松加入，但由于附庸是领袖，拜占庭无法召唤其盟友

**观察问题 6 的步骤**（AI 附庸次优决策）：

1. 加载拜占庭存档 1339.2.1 - Byzantium HUD ERE War Stuck
2. 占领所有叛军领土并将控制权转移给附庸 Hudavendigar
3. 达到 45%+ 战争分数
4. 等待 AI 附庸 Hudavendigar 议和
5. 观察 AI 附庸选择无条件和约，而不是吞并归并国，尽管吞并只花费 2 和平提议点数
6. 观察拜占庭失去 7 个地点，这些地点成为新的归并国，成为埃雷特纳的附庸

**观察问题 7 的步骤**（宗主国被迫加入）：

1. 加载内战期间的任何拜占庭存档
2. 观察拜占庭（Hudavendigar 的宗主国）自动被拖入战争
3. 观察这是通过 `secessionists.txt` 中的 `join_defensive_wars_always` 发生的

### 案例 2：法兰西存档 - 联合统治破裂（演示问题 2）

存档文件 ID：**#51d1fcfd**

加载法兰西联合统治存档文件。存档演示：
- 法兰西 has formed a 联合统治 with 西西里 (法兰西 as 邦联主导国)
- 法兰西 has conquered Sicilian-culture territory from 那不勒斯
- Sicilian 归并国叛乱 is ready to spawn

**观察问题 2 的步骤**（联合统治破裂）：

1. 加载存档 1337.5.1.2 - 法兰西联合统治西西里, No CB 那不勒斯
   - 法兰西使用控制台命令 `create_pu SIC` 与西西里形成联合统治
   - 法兰西向那不勒斯宣战 No CB 战争
2. 加载存档 1337.6.1 - 法兰西征服那不勒斯
   - 法兰西征服了 Calabria Ultra 省份（西西里文化）
3. 加载存档 1337.7.1 - 法兰西西西里叛军 100%
   - 使用控制台命令将西西里叛乱进度设置为 100%
4. 加载存档 1337.8.1 - 法兰西联合统治破裂
   - 归并国叛乱爆发
   - 观察西西里（西西里文化的文化主导国家）被强制召唤支持叛乱
   - 观察法兰西和西西里之间的联合统治在第一天立即破裂
   - 观察西西里现在与法兰西（其前邦联主导国）处于战争状态

**对其他属国类型保护的验证：**

以下存档证明附庸和采邑被正确排除在归并国召唤之外。然而，其他属国类型尚未测试，可能也受到影响：

**EU5 属国类型（状态）：**
- 联合统治：**已验证受影响**
- 附庸：**已验证被排除**
- 采邑：**已验证被排除**
- 朝贡国、自治领、卫戍国、封邑、三曼多、土司、乌奇贝伊等：未测试

### 案例 3：法兰西存档 - 采邑（不召唤）

存档文件 ID：**#1177c64a**

1. 加载存档 1337.4.1 - 法兰西吞并西西里, 创建采邑属国
   - 法兰西使用控制台命令吞并西西里
   - 创建新的西西里采邑属国
2. 加载存档 1337.6.1 - 法兰西征服那不勒斯
   - 法兰西征服了 Calabria Ultra 省份（西西里文化）
3. 加载存档 1337.7.1 - 法兰西西西里叛军 100%
   - 使用控制台命令将西西里叛乱进度设置为 100%
4. 加载存档 1337.8.1 - 法兰西西西里归并国不召唤西西里
   - 归并国叛乱爆发
   - 观察西西里（采邑）未被召唤支持叛乱
   - 这证明采邑被正确排除

### 案例 4：法兰西存档 - 附庸（不召唤）

存档文件 ID：**#dae84461**

1. 加载存档 1337.4.1 - 法兰西吞并西西里, 创建附庸属国
   - 法兰西使用控制台命令吞并西西里
   - 创建新的西西里附庸属国
2. 加载存档 1337.6.10 - 法兰西征服那不勒斯
   - 法兰西征服了 Calabria Ultra 省份（西西里文化）
3. 加载存档 1337.7.1 - 法兰西西西里叛军 100%
   - 使用控制台命令将西西里叛乱进度设置为 100%
4. 加载存档 1337.8.1 - 法兰西归并国不召唤西西里附庸
   - 归并国叛乱爆发
   - 观察西西里（附庸）未被召唤支持叛乱
   - 这证明附庸被正确排除

**结论：** 联合统治已验证会收到归并国召唤，而附庸和采邑已验证被排除。这造成不一致性，联合统治破裂，而其他一些属国类型受到保护。其他属国类型尚未测试，可能也受到影响。

### 案例 5：法兰西存档 - 包围网绕过和停战协议破坏（演示问题 1、5 和 8）

存档文件 ID：**#75e13d1**

加载法兰西存档文件。存档设置如下：
- 法兰西与阿拉贡和罗马形成同盟
- 法兰西在 No CB 战争中击败卡斯蒂利亚并占领卡斯蒂利亚领土
- 卡斯蒂利亚归并国叛乱准备生成（或已生成）
- 卡斯蒂利亚可能处于针对法兰西的包围网中（或将在停战协议结束后加入）

**观察问题 1 的步骤**（同文化国家被迫加入）：

1. 加载法兰西存档 1338.4.1 - 法兰西与卡斯蒂利亚停战协议, 添加卡斯蒂利亚叛军至 100%
2. 使用控制台命令将卡斯蒂利亚叛乱进度强制设置为 100%
3. 当归并国叛军并宣布内战时，观察卡斯蒂利亚自动被强制召唤加入叛军一方参战
4. 观察卡斯蒂利亚无法拒绝此召唤 - 它被迫参战

**观察问题 8 的步骤**（停战协议破坏）：

1. 加载法兰西存档 1338.4.1 - 法兰西与卡斯蒂利亚停战协议, 添加卡斯蒂利亚叛军至 100%
2. 如果卡斯蒂利亚和法兰西在叛乱战争开始时停战协议，观察卡斯蒂利亚在叛乱爆发后的下一个月因"破坏停战协议"受到 -50 稳定度惩罚
3. 观察卡斯蒂利亚被判定为主动破坏停战协议，尽管它被强制召唤参战且没有选择

**观察问题 5 的步骤**（包围网绕过）：

1. 加载法兰西存档 1346.8.2 - 法兰西卡斯蒂利亚联合包围网, 添加卡斯蒂利亚叛军至 100%
2. 卡斯蒂利亚已加入针对法兰西的包围网
3. 当归并国叛军时，观察卡斯蒂利亚被强制召唤作为进攻方（叛军一方）参战
4. 观察卡斯蒂利亚无法召唤包围网成员（葡萄牙、纳瓦拉）加入战争，因为它是攻击者
5. 观察法兰西（防御方）可以召唤同盟（阿拉贡、罗马）加入防御性战争
6. 结果：法兰西可以绕过包围网单独攻击卡斯蒂利亚，而卡斯蒂利亚无法获得包围网或盟友支持
7. 观察卡斯蒂利亚将在叛乱战争结束后离开包围网

### 案例 6：法兰西 vs 卡斯蒂利亚无地叛军行为（演示问题 12 - 已验证）

存档文件 ID：**#39d23961**

加载法兰西 vs 卡斯蒂利亚无地叛军存档文件。存档演示：
- 卡斯蒂利亚 has conquered Loudun (French culture territory)
- French 归并国叛乱 spawns as 群众集会 (<50% French culture population)
- 法兰西 (culturally dominant) is forcibly called to support the 叛乱

**观察问题 12 的步骤**（无地叛军行为）：

1. 加载存档 1337.5.1 - 卡斯蒂利亚征服 Loudun, 添加叛乱 100%
   - 作为卡斯蒂利亚游戏
   - 控制台：`conquer loudun`
   - 将叛乱进度添加到 1（100%）
2. 加载存档 1337.6.1 - 法兰西加入分离主义战争, 占领卡斯蒂利亚, 1 - 无土地转移给 AAA00
   - 作为法兰西游戏
   - 控制台：`occupy_country CAS` 以获得 100% 战争分数
   - 观察：无土地转移给新生成的标签 AAA00（无地叛军）
3. 加载存档 1337.6.1 - 法兰西加入分离主义战争, 占领卡斯蒂利亚, 2 - Loudun 转移给 AAA00
   - 作为法兰西游戏
   - 控制台：`occupy_country CAS` 以获得 100% 战争分数
   - 观察：Loudun 转移给新生成的标签 AAA00（无地叛军）
4. 加载存档 1337.8.1 - 法兰西 1. 设置现金 0
   - 存档 2 后 2 个月
   - 将现金设置为 0 以检查获得的战争赔款
5. 加载存档 1337.8.9 - 法兰西 1. 获得 350.72 战争赔款, AAA00 成为无地分离主义者
   - 存档 2 后 9 天
   - AAA00 与卡斯蒂利亚议和
   - 观察：法兰西获得 350.72 杜卡特，AAA00 是无地归并国附庸，有 1 个单位骑兵（5 人）
6. 加载存档 1337.8.1 - 法兰西 2. 设置现金 0
   - 存档 3 后 2 个月
   - 将现金设置为 0 以检查获得的战争赔款
7. 加载存档 1337.8.11 - 法兰西 2. 获得 314.82 战争赔款, AAA00 成为有地独立国家
   - 存档 2 后 11 天
   - AAA00 与卡斯蒂利亚议和
   - 观察：法兰西获得 314.82 杜卡特，AAA00 现在是定居国家，但**不是**法兰西的归并国附庸

**关键观察：**
- 两个主要国家（法兰西和卡斯蒂利亚）为基本上一无所获而战斗
- 100% 战争分数的最佳情况：法兰西只获得 314.82 到 350.72 杜卡特（战争赔款）
- 无地叛军（AAA00）要么：
  1. 成为无地归并国附庸，有 1 个单位骑兵（5 人）- 实际上无用
  2. 成为定居国家，但**不是**法兰西的归并国附庸 - 完全独立
- 这证明分离主义概念对无地叛军完全失效 - 对于无地分离主义者来说，在分离主义战争中战斗几乎没有好处，因为所谓的宗主国法兰西几乎一无所获，如果无地叛军成为定居国家，它不会成为法兰西的有用附庸

### 案例 7：卡斯蒂利亚存档 - 攻击者盟友召唤（演示问题 4 - 已验证）

存档文件 ID：**#db345ae3**

加载卡斯蒂利亚存档文件。存档演示：
- 卡斯蒂利亚 has 同盟 with 葡萄牙
- 卡斯蒂利亚 has conquered Loudun (French culture territory)
- French 归并国叛乱 spawns as 群众集会 (<50% French culture population)
- 法兰西 (culturally dominant) is forcibly called to support the 叛乱
- 法兰西 has 同盟 with 阿拉贡 and 罗马
- 法兰西 has 100 人情 with 阿拉贡 and 罗马

**观察问题 4 的步骤**（使用人情召唤攻击者盟友）：

1. 加载存档 1337.5.1 - 卡斯蒂利亚盟友葡萄牙, 征服 Loudun, 添加叛乱 100%
   - 作为卡斯蒂利亚游戏
   - 卡斯蒂利亚与葡萄牙有同盟
   - 控制台：`conquer loudun`
   - 将叛乱进度添加到 1（100%）
2. 加载存档 1337.5.1 - 法兰西盟友罗马, 阿拉贡, 人情 100
   - 切换标签作为法兰西游戏
   - 法兰西与阿拉贡、罗马结盟
   - 使用控制台命令 `favor ARA 100` 和 `favor PAP 100` 添加人情
3. 加载存档 1337.6.1 - 法兰西分离主义战争
   - 归并国叛军在 1337.6.1 爆发
   - Loudun 中的群众集会叛军是战争领袖，因此法兰西无法召唤阿拉贡和罗马参战
4. 加载存档 1337.6.3 - 法兰西消灭无地叛军, 可以召唤阿拉贡和罗马
   - 使用控制台命令 `kill_unit` 消灭群众集会归并国叛军部队
   - 法兰西成为战争领袖
   - 法兰西可以使用人情召唤阿拉贡和罗马加入战争

---

## 提供的游戏存档

已准备并附上多个游戏存档：

**拜占庭存档**（问题 1、3、4、6、7）：
存档文件 ID：**#f40b1288**
- 1337.7.2 - Byzantium HUD Revolt 100%
- 1337.8.1 - Byzantium HUD ERE War
- 1339.2.1 - Byzantium HUD ERE War Stuck
- 演示各种场景的其他存档

**法兰西联合统治存档**（问题 2 - 已验证）：
存档文件 ID：**#51d1fcfd**
- 1337.5.1.2 - 法兰西联合统治西西里, No CB 那不勒斯
- 1337.6.1 - 法兰西征服那不勒斯
- 1337.7.1 - 法兰西西西里叛军 100%
- 1337.8.1 - 法兰西联合统治破裂

**法兰西采邑存档**（验证 - 不召唤）：
存档文件 ID：**#1177c64a**
- 1337.4.1 - 法兰西吞并西西里, 创建采邑属国
- 1337.6.1 - 法兰西征服那不勒斯
- 1337.7.1 - 法兰西西西里叛军 100%
- 1337.8.1 - 法兰西西西里归并国不召唤西西里

**法兰西附庸存档**（验证 - 不召唤）：
存档文件 ID：**#dae84461**
- 1337.4.1 - 法兰西吞并西西里, 创建附庸属国
- 1337.6.10 - 法兰西征服那不勒斯
- 1337.7.1 - 法兰西西西里叛军 100%
- 1337.8.1 - 法兰西分离主义不召唤西西里附庸

**法兰西包围网/停战协议存档**（问题 1、5、8）：
存档文件 ID：**#75e13d1**
- 1338.4.1 - 法兰西与卡斯蒂利亚停战协议, 添加卡斯蒂利亚叛军至 100%
- 1346.8.2 - 法兰西卡斯蒂利亚联合包围网, 添加卡斯蒂利亚叛军至 100%
- 演示各种场景的其他存档

**法兰西 vs 卡斯蒂利亚无地叛军存档**（问题 12 - 已验证）：
存档文件 ID：**#39d23961**
- 1337.5.1 - 卡斯蒂利亚征服 Loudun, 添加叛乱 100%
- 1337.6.1 - 法兰西加入分离主义战争, 占领卡斯蒂利亚, 1 - 无土地转移给 AAA00
- 1337.6.1 - 法兰西加入分离主义战争, 占领卡斯蒂利亚, 2 - Loudun 转移给 AAA00
- 1337.8.1 - 法兰西 1. 设置现金 0
- 1337.8.9 - 法兰西 1. 获得 350.72 战争赔款, AAA00 成为无地分离主义者
- 1337.8.1 - 法兰西 2. 设置现金 0
- 1337.8.11 - 法兰西 2. 获得 314.82 战争赔款, AAA00 成为有地独立国家

**卡斯蒂利亚存档 - 攻击者盟友召唤**（问题 4 - 已验证）：
存档文件 ID：**#db345ae3**
- 1337.5.1 - 卡斯蒂利亚盟友葡萄牙, 征服 Loudun, 添加叛乱 100%
- 1337.5.1 - 法兰西盟友罗马, 阿拉贡, 人情 100
- 1337.6.1 - 法兰西分离主义战争
- 1337.6.3 - 法兰西消灭无地叛军, 可以召唤阿拉贡和罗马

---

## 相关文件

- `game/in_game/common/subject_types/secessionists.txt` (lines 12-17: `join_offensive_wars_always`, `join_defensive_wars_always`)
- `game/in_game/common/subject_types/vassal.txt`
- `game/in_game/common/scripted_relations/alliance.txt` (lines 13-14: `called_in_defensively`, `called_in_offensively`)
- `game/in_game/common/scripted_relations/union_of_crowns_pact.txt` (line 10: `break_on_war = yes`)
- `game/in_game/common/on_action/_hardcoded.txt` (第 717-777 行：`on_civil_war_start` - 用于召唤同文化国家的硬编码机制)
- `game/in_game/common/scripted_effects/global_effects.txt` (line 218: `start_civil_war`)
- `game/in_game/common/prices/00_hardcoded.txt` (第 100-103 行：`war_breaking_truce` - stability = 50, war_exhaustion = 1)
- `game/in_game/common/biases/05_antagonism_hardcoded.txt` (第 35-38 行：`antagonism_breaking_truce` - value = 25)
- `game/in_game/common/wargoals/00_default.txt` (第 89-99 行：`take_country_nationalist` - `type = take_country`, `conquer_cost = 0.25`, `subjugate_cost = 0.25` - 归并国战争的低战争分数成本，用于吞并叛军，但当参战国因问题 10 成为战争领袖时可被利用。`type = take_country` 允许通过吞并叛军按钮吞并整个国家)
- `game/main_menu/localization/english/war_overview_l_english.yml` (第 8 行：`WAR_LATERALVIEW_ANNEX_REVOLTER: "Annex Revolter"` - 允许吞并叛乱者国家的和平选项)
- `game/main_menu/localization/english/diplomacy_l_english.yml` (第 1149-1150 行：`PEACE_TREATY_ANNEX_REVOLTER` - 吞并叛乱者的和平条约描述)
- `game/loading_screen/common/defines/00_defines.txt` (第 1673 行：`MIN_WARSCORE_TO_DEMAND = 10` - 启用吞并叛军等和平选项所需的最低战争分数；第 1832-1833 行：`PEACE_TREATY_ANNEX_REVOLTER_MAX_COST = 70`, `PEACE_TREATY_REVOLTER_SURVIVES_MAX_COST = 70`)
